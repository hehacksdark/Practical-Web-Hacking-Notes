# Lab: SSRF with Filter Bypass via Open Redirection Vulnerability  

## Steps to Exploit  

1. **Intercept Request:**  
   - Visit a product page and click "Check stock".  
   - Intercept the request in **Burp Suite** and send it to **Repeater**.  

2. **Test SSRF Restrictions:**  
   - Modify the `stockApi` parameter and observe that requests to external hosts are blocked.  

3. **Find Open Redirect:**  
   - Click "Next product" and check the `path` parameter.  
   - Observe that it is reflected in the **Location header**, causing an **open redirection**.  

4. **Exploit Open Redirect for SSRF:**  
   - Modify the `stockApi` parameter to **redirect requests to the admin interface**:  

     ```
     /product/nextProduct?path=http://192.168.0.12:8080/admin
     ```

   - The stock checker follows the redirection and loads the **admin panel**.  

5. **Delete the Target User:**  
   - Modify the `path` parameter to execute the **delete request**:  

     ```
     /product/nextProduct?path=http://192.168.0.12:8080/admin/delete?username=carlos
     ```

## Key Takeaways  

- **SSRF filters can be bypassed using open redirection vulnerabilities.**  
- **The server follows the redirect**, allowing access to internal resources.  
- **Always test for open redirects when SSRF seems restricted.**  

ðŸ”¥ **Successfully exploited SSRF via open redirection!** ðŸš€  

# Bypassing SSRF Whitelist-Based Input Filters

## Techniques to Bypass Whitelist Restrictions

### 1. Credential Injection (`@`)
https://expected-host:fakepassword@evil-host

### 2. URL Fragment Trick (`#`)
https://evil-host#expected-host

### 3. Subdomain Misuse (DNS Hierarchy)
https://expected-host.evil-host  

### 4. URL Encoding & Double Encoding
https://evil%2Dhost
https://evil%252Dhost  

### 5. Combining Multiple Techniques
https://expected-host:password@evil-host#expected-host  
